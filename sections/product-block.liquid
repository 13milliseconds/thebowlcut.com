{% assign related_products = article.metafields.products.related.value %}

{% if related_products %}
<div class="featured-products-container container">
  <h1>PRODUCTS IN THIS RECIPE</h1>
  <div class="featured-products-grid">
    {% for related_product in related_products %}
    <div class="featured-product-block">
      <a href="{{ related_product.url }}">
        <div class="product-image">
          {{ related_product.featured_image | img_url: 'medium' | img_tag: related_product.title }}
        </div>
        <div class="product-details">
          <h4>{{ related_product.title }}</h4>
          <p>{{ related_product.description | strip_html | truncatewords: 30 }}</p>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

{% schema %}
{
  "name": "Shop the Product",
  "settings": [],
  "presets": [
    {
      "name": "Shop the Product"
    }
  ]
}
{% endschema %}

{% stylesheet %}
.featured-products-container {
  display: flex;
  flex-direction: column;
  margin-bottom: 2rem;
}

.featured-products-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 1rem;
}

.featured-product-block {
  display: flex;
  flex-direction: column;
  align-items: left;
  gap: 1rem;
}

.featured-product-block .product-image {
  flex-basis: 50%;
  height: auto;
}

.featured-product-block .product-details {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}
{% endstylesheet %}
